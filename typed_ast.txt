TyProgram(
    [
        TyNodeDecl(
            TyNodeDecl {
                name: "Mnist",
                ty_sig: [!4, !5, !6, !7, !7] -> [!4, !3, !3]
            }
        ),
        TyWeightsDecl(
            TyWeightsDecl {
                name: "Mnist",
                ty_sig: [!4, !5, !6, !7, !7] -> [!4, !3, !3],
                inits: [
                    TyWeightsAssign {
                        name: "conv1",
                        ty: ?9,
                        mod_name: "Conv2d",
                        fn_ty: ?8,
                        fn_name: "new",
                        fn_args: [
                            TyFnAppArg {
                                name: "in_ch",
                                arg: TyExpr {
                                    items: TyInteger(
                                        ?10,
                                        1
                                    ),
                                    ty: ?11
                                }
                            },
                            TyFnAppArg {
                                name: "out_ch",
                                arg: TyExpr {
                                    items: TyInteger(
                                        ?12,
                                        10
                                    ),
                                    ty: ?13
                                }
                            },
                            TyFnAppArg {
                                name: "kernel_size",
                                arg: TyExpr {
                                    items: TyInteger(
                                        ?14,
                                        5
                                    ),
                                    ty: ?15
                                }
                            }
                        ]
                    },
                    TyWeightsAssign {
                        name: "conv2",
                        ty: ?17,
                        mod_name: "Conv2d",
                        fn_ty: ?16,
                        fn_name: "new",
                        fn_args: [
                            TyFnAppArg {
                                name: "in_ch",
                                arg: TyExpr {
                                    items: TyInteger(
                                        ?18,
                                        10
                                    ),
                                    ty: ?19
                                }
                            },
                            TyFnAppArg {
                                name: "out_ch",
                                arg: TyExpr {
                                    items: TyInteger(
                                        ?20,
                                        20
                                    ),
                                    ty: ?21
                                }
                            },
                            TyFnAppArg {
                                name: "kernel_size",
                                arg: TyExpr {
                                    items: TyInteger(
                                        ?22,
                                        5
                                    ),
                                    ty: ?23
                                }
                            }
                        ]
                    },
                    TyWeightsAssign {
                        name: "dropout",
                        ty: ?25,
                        mod_name: "Dropout2d",
                        fn_ty: ?24,
                        fn_name: "new",
                        fn_args: [
                            TyFnAppArg {
                                name: "p",
                                arg: TyExpr {
                                    items: TyFloat(
                                        ?26,
                                        0.5
                                    ),
                                    ty: ?27
                                }
                            }
                        ]
                    },
                    TyWeightsAssign {
                        name: "fc1",
                        ty: ?29,
                        mod_name: "Linear",
                        fn_ty: ?28,
                        fn_name: "new",
                        fn_args: []
                    },
                    TyWeightsAssign {
                        name: "fc2",
                        ty: ?31,
                        mod_name: "Linear",
                        fn_ty: ?30,
                        fn_name: "new",
                        fn_args: []
                    }
                ]
            }
        ),
        TyGraphDecl(
            TyGraphDecl {
                name: "Mnist",
                ty_sig: [!4, !5, !6, !7, !7] -> [!4, !3, !3],
                fns: [
                    TyFnDecl {
                        name: "new",
                        fn_params: [],
                        return_ty: ?32,
                        func_block: TyBlock {
                            stmts: TyList(
                                [
                                    TyStmt {
                                        items: TyList(
                                            [
                                                TyExpr {
                                                    items: TyFnApp(
                                                        TyFnApp {
                                                            mod_name: Some(
                                                                "fc1"
                                                            ),
                                                            name: "init_normal",
                                                            args: [
                                                                TyFnAppArg {
                                                                    name: "std",
                                                                    arg: TyExpr {
                                                                        items: TyFloat(
                                                                            ?33,
                                                                            1.0
                                                                        ),
                                                                        ty: ?34
                                                                    }
                                                                }
                                                            ],
                                                            ret_ty: ?35
                                                        }
                                                    ),
                                                    ty: ?36
                                                }
                                            ]
                                        )
                                    },
                                    TyStmt {
                                        items: TyList(
                                            [
                                                TyExpr {
                                                    items: TyFnApp(
                                                        TyFnApp {
                                                            mod_name: Some(
                                                                "fc2"
                                                            ),
                                                            name: "init_normal",
                                                            args: [
                                                                TyFnAppArg {
                                                                    name: "std",
                                                                    arg: TyExpr {
                                                                        items: TyFloat(
                                                                            ?37,
                                                                            1.0
                                                                        ),
                                                                        ty: ?38
                                                                    }
                                                                }
                                                            ],
                                                            ret_ty: ?39
                                                        }
                                                    ),
                                                    ty: ?40
                                                }
                                            ]
                                        )
                                    }
                                ]
                            ),
                            ret: TyNone
                        }
                    },
                    TyFnDecl {
                        name: "forward",
                        fn_params: [
                            TyFnDeclParam {
                                name: "x",
                                ty_sig: ?41
                            }
                        ],
                        return_ty: ?42,
                        func_block: TyBlock {
                            stmts: TyList(
                                []
                            ),
                            ret: TyExpr {
                                items: TyPipes(
                                    TyPipes {
                                        items: [
                                            TyIdent(
                                                ?41,
                                                "x"
                                            ),
                                            TyFnApp(
                                                TyFnApp {
                                                    mod_name: None,
                                                    name: "conv1",
                                                    args: [
                                                        TyFnAppArg {
                                                            name: "x",
                                                            arg: TyIdent(
                                                                ?41,
                                                                "x"
                                                            )
                                                        }
                                                    ],
                                                    ret_ty: ?43
                                                }
                                            ),
                                            TyFnApp(
                                                TyFnApp {
                                                    mod_name: None,
                                                    name: "maxpool2d",
                                                    args: [
                                                        TyFnAppArg {
                                                            name: "x",
                                                            arg: TyFnApp(
                                                                TyFnApp {
                                                                    mod_name: None,
                                                                    name: "conv1",
                                                                    args: [
                                                                        TyFnAppArg {
                                                                            name: "x",
                                                                            arg: TyIdent(
                                                                                ?41,
                                                                                "x"
                                                                            )
                                                                        }
                                                                    ],
                                                                    ret_ty: ?43
                                                                }
                                                            )
                                                        },
                                                        TyFnAppArg {
                                                            name: "xkernel_size",
                                                            arg: TyExpr {
                                                                items: TyInteger(
                                                                    ?44,
                                                                    2
                                                                ),
                                                                ty: ?45
                                                            }
                                                        }
                                                    ],
                                                    ret_ty: ?46
                                                }
                                            ),
                                            TyFnApp(
                                                TyFnApp {
                                                    mod_name: None,
                                                    name: "conv2",
                                                    args: [
                                                        TyFnAppArg {
                                                            name: "x",
                                                            arg: TyFnApp(
                                                                TyFnApp {
                                                                    mod_name: None,
                                                                    name: "maxpool2d",
                                                                    args: [
                                                                        TyFnAppArg {
                                                                            name: "x",
                                                                            arg: TyFnApp(
                                                                                TyFnApp {
                                                                                    mod_name: None,
                                                                                    name: "conv1",
                                                                                    args: [
                                                                                        TyFnAppArg {
                                                                                            name: "x",
                                                                                            arg: TyIdent(
                                                                                                ?41,
                                                                                                "x"
                                                                                            )
                                                                                        }
                                                                                    ],
                                                                                    ret_ty: ?43
                                                                                }
                                                                            )
                                                                        },
                                                                        TyFnAppArg {
                                                                            name: "xkernel_size",
                                                                            arg: TyExpr {
                                                                                items: TyInteger(
                                                                                    ?44,
                                                                                    2
                                                                                ),
                                                                                ty: ?45
                                                                            }
                                                                        }
                                                                    ],
                                                                    ret_ty: ?46
                                                                }
                                                            )
                                                        }
                                                    ],
                                                    ret_ty: ?47
                                                }
                                            ),
                                            TyFnApp(
                                                TyFnApp {
                                                    mod_name: None,
                                                    name: "dropout",
                                                    args: [
                                                        TyFnAppArg {
                                                            name: "x",
                                                            arg: TyFnApp(
                                                                TyFnApp {
                                                                    mod_name: None,
                                                                    name: "conv2",
                                                                    args: [
                                                                        TyFnAppArg {
                                                                            name: "x",
                                                                            arg: TyFnApp(
                                                                                TyFnApp {
                                                                                    mod_name: None,
                                                                                    name: "maxpool2d",
                                                                                    args: [
                                                                                        TyFnAppArg {
                                                                                            name: "x",
                                                                                            arg: TyFnApp(
                                                                                                TyFnApp {
                                                                                                    mod_name: None,
                                                                                                    name: "conv1",
                                                                                                    args: [
                                                                                                        TyFnAppArg {
                                                                                                            name: "x",
                                                                                                            arg: TyIdent(
                                                                                                                ?41,
                                                                                                                "x"
                                                                                                            )
                                                                                                        }
                                                                                                    ],
                                                                                                    ret_ty: ?43
                                                                                                }
                                                                                            )
                                                                                        },
                                                                                        TyFnAppArg {
                                                                                            name: "xkernel_size",
                                                                                            arg: TyExpr {
                                                                                                items: TyInteger(
                                                                                                    ?44,
                                                                                                    2
                                                                                                ),
                                                                                                ty: ?45
                                                                                            }
                                                                                        }
                                                                                    ],
                                                                                    ret_ty: ?46
                                                                                }
                                                                            )
                                                                        }
                                                                    ],
                                                                    ret_ty: ?47
                                                                }
                                                            )
                                                        }
                                                    ],
                                                    ret_ty: ?48
                                                }
                                            ),
                                            TyFnApp(
                                                TyFnApp {
                                                    mod_name: None,
                                                    name: "maxpool2d",
                                                    args: [
                                                        TyFnAppArg {
                                                            name: "x",
                                                            arg: TyFnApp(
                                                                TyFnApp {
                                                                    mod_name: None,
                                                                    name: "dropout",
                                                                    args: [
                                                                        TyFnAppArg {
                                                                            name: "x",
                                                                            arg: TyFnApp(
                                                                                TyFnApp {
                                                                                    mod_name: None,
                                                                                    name: "conv2",
                                                                                    args: [
                                                                                        TyFnAppArg {
                                                                                            name: "x",
                                                                                            arg: TyFnApp(
                                                                                                TyFnApp {
                                                                                                    mod_name: None,
                                                                                                    name: "maxpool2d",
                                                                                                    args: [
                                                                                                        TyFnAppArg {
                                                                                                            name: "x",
                                                                                                            arg: TyFnApp(
                                                                                                                TyFnApp {
                                                                                                                    mod_name: None,
                                                                                                                    name: "conv1",
                                                                                                                    args: [
                                                                                                                        TyFnAppArg {
                                                                                                                            name: "x",
                                                                                                                            arg: TyIdent(
                                                                                                                                ?41,
                                                                                                                                "x"
                                                                                                                            )
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    ret_ty: ?43
                                                                                                                }
                                                                                                            )
                                                                                                        },
                                                                                                        TyFnAppArg {
                                                                                                            name: "xkernel_size",
                                                                                                            arg: TyExpr {
                                                                                                                items: TyInteger(
                                                                                                                    ?44,
                                                                                                                    2
                                                                                                                ),
                                                                                                                ty: ?45
                                                                                                            }
                                                                                                        }
                                                                                                    ],
                                                                                                    ret_ty: ?46
                                                                                                }
                                                                                            )
                                                                                        }
                                                                                    ],
                                                                                    ret_ty: ?47
                                                                                }
                                                                            )
                                                                        }
                                                                    ],
                                                                    ret_ty: ?48
                                                                }
                                                            )
                                                        },
                                                        TyFnAppArg {
                                                            name: "kernel_size",
                                                            arg: TyExpr {
                                                                items: TyInteger(
                                                                    ?49,
                                                                    2
                                                                ),
                                                                ty: ?50
                                                            }
                                                        }
                                                    ],
                                                    ret_ty: ?51
                                                }
                                            ),
                                            TyViewFn(
                                                TyViewFn {
                                                    ty: [!4, !1, !1]
                                                }
                                            ),
                                            TyFnApp(
                                                TyFnApp {
                                                    mod_name: None,
                                                    name: "fc1",
                                                    args: [
                                                        TyFnAppArg {
                                                            name: "x",
                                                            arg: TyViewFn(
                                                                TyViewFn {
                                                                    ty: [!4, !1, !1]
                                                                }
                                                            )
                                                        }
                                                    ],
                                                    ret_ty: ?52
                                                }
                                            ),
                                            TyFnApp(
                                                TyFnApp {
                                                    mod_name: None,
                                                    name: "relu",
                                                    args: [
                                                        TyFnAppArg {
                                                            name: "x",
                                                            arg: TyFnApp(
                                                                TyFnApp {
                                                                    mod_name: None,
                                                                    name: "fc1",
                                                                    args: [
                                                                        TyFnAppArg {
                                                                            name: "x",
                                                                            arg: TyViewFn(
                                                                                TyViewFn {
                                                                                    ty: [!4, !1, !1]
                                                                                }
                                                                            )
                                                                        }
                                                                    ],
                                                                    ret_ty: ?52
                                                                }
                                                            )
                                                        }
                                                    ],
                                                    ret_ty: ?53
                                                }
                                            ),
                                            TyFnApp(
                                                TyFnApp {
                                                    mod_name: Some(
                                                        "self"
                                                    ),
                                                    name: "fc2",
                                                    args: [
                                                        TyFnAppArg {
                                                            name: "x",
                                                            arg: TyFnApp(
                                                                TyFnApp {
                                                                    mod_name: None,
                                                                    name: "relu",
                                                                    args: [
                                                                        TyFnAppArg {
                                                                            name: "x",
                                                                            arg: TyFnApp(
                                                                                TyFnApp {
                                                                                    mod_name: None,
                                                                                    name: "fc1",
                                                                                    args: [
                                                                                        TyFnAppArg {
                                                                                            name: "x",
                                                                                            arg: TyViewFn(
                                                                                                TyViewFn {
                                                                                                    ty: [!4, !1, !1]
                                                                                                }
                                                                                            )
                                                                                        }
                                                                                    ],
                                                                                    ret_ty: ?52
                                                                                }
                                                                            )
                                                                        }
                                                                    ],
                                                                    ret_ty: ?53
                                                                }
                                                            )
                                                        }
                                                    ],
                                                    ret_ty: ?54
                                                }
                                            ),
                                            TyFnApp(
                                                TyFnApp {
                                                    mod_name: None,
                                                    name: "log_softmax",
                                                    args: [
                                                        TyFnAppArg {
                                                            name: "x",
                                                            arg: TyFnApp(
                                                                TyFnApp {
                                                                    mod_name: Some(
                                                                        "self"
                                                                    ),
                                                                    name: "fc2",
                                                                    args: [
                                                                        TyFnAppArg {
                                                                            name: "x",
                                                                            arg: TyFnApp(
                                                                                TyFnApp {
                                                                                    mod_name: None,
                                                                                    name: "relu",
                                                                                    args: [
                                                                                        TyFnAppArg {
                                                                                            name: "x",
                                                                                            arg: TyFnApp(
                                                                                                TyFnApp {
                                                                                                    mod_name: None,
                                                                                                    name: "fc1",
                                                                                                    args: [
                                                                                                        TyFnAppArg {
                                                                                                            name: "x",
                                                                                                            arg: TyViewFn(
                                                                                                                TyViewFn {
                                                                                                                    ty: [!4, !1, !1]
                                                                                                                }
                                                                                                            )
                                                                                                        }
                                                                                                    ],
                                                                                                    ret_ty: ?52
                                                                                                }
                                                                                            )
                                                                                        }
                                                                                    ],
                                                                                    ret_ty: ?53
                                                                                }
                                                                            )
                                                                        }
                                                                    ],
                                                                    ret_ty: ?54
                                                                }
                                                            )
                                                        },
                                                        TyFnAppArg {
                                                            name: "dim",
                                                            arg: TyExpr {
                                                                items: TyInteger(
                                                                    ?55,
                                                                    1
                                                                ),
                                                                ty: ?56
                                                            }
                                                        }
                                                    ],
                                                    ret_ty: ?57
                                                }
                                            )
                                        ],
                                        ret_ty: ()
                                    }
                                ),
                                ty: ?58
                            }
                        }
                    },
                    TyFnDecl {
                        name: "fc2",
                        fn_params: [
                            TyFnDeclParam {
                                name: "x",
                                ty_sig: ?59
                            }
                        ],
                        return_ty: ?60,
                        func_block: TyBlock {
                            stmts: TyList(
                                []
                            ),
                            ret: TyExpr {
                                items: TyPipes(
                                    TyPipes {
                                        items: [
                                            TyIdent(
                                                ?59,
                                                "x"
                                            ),
                                            TyFnApp(
                                                TyFnApp {
                                                    mod_name: None,
                                                    name: "fc2",
                                                    args: [
                                                        TyFnAppArg {
                                                            name: "x",
                                                            arg: TyIdent(
                                                                ?59,
                                                                "x"
                                                            )
                                                        }
                                                    ],
                                                    ret_ty: ?61
                                                }
                                            ),
                                            TyFnApp(
                                                TyFnApp {
                                                    mod_name: None,
                                                    name: "relu",
                                                    args: [
                                                        TyFnAppArg {
                                                            name: "x",
                                                            arg: TyFnApp(
                                                                TyFnApp {
                                                                    mod_name: None,
                                                                    name: "fc2",
                                                                    args: [
                                                                        TyFnAppArg {
                                                                            name: "x",
                                                                            arg: TyIdent(
                                                                                ?59,
                                                                                "x"
                                                                            )
                                                                        }
                                                                    ],
                                                                    ret_ty: ?61
                                                                }
                                                            )
                                                        }
                                                    ],
                                                    ret_ty: ?62
                                                }
                                            )
                                        ],
                                        ret_ty: ()
                                    }
                                ),
                                ty: ?63
                            }
                        }
                    }
                ]
            }
        )
    ]
)
TypeEnv {
    counter: 63,
    current_mod: Global,
    modules: {
        Global: [],
        Named(
            "Mnist"
        ): [
            Scope {
                aliases: {
                    "x": ?59,
                    "c": !5,
                    "FC1": !1,
                    "?": !4,
                    "TEST": [!4, !2, !2],
                    "w": !7,
                    "OUT": !3,
                    "IMAGE": [!4, !5, !6, !7, !7],
                    "dropout": ?24,
                    "fc2": ?30,
                    "conv1": ?8,
                    "conv2": ?16,
                    "h": !6,
                    "FC2": !2,
                    "fc1": ?28
                }
            }
        ]
    }
}
